DECLARE HASHED_EMAIL_ARRAY DEFAULT
[
  TO_BASE64(SHA512('jdoe@example.com')),
  TO_BASE64(SHA512('lsmith@example.com')),
  TO_BASE64(SHA512('mjohnson@example.com')),
  TO_BASE64(SHA512('kjones@example.com')),
  TO_BASE64(SHA512('nhernandez@example.com')),
  TO_BASE64(SHA512('glee@example.com')),
  TO_BASE64(SHA512('pgonzalez@example.com')),
  TO_BASE64(SHA512('sramirez@example.com')),
  TO_BASE64(SHA512('cpeterson@example.com')),
  TO_BASE64(SHA512('jdavis@example.com')),
  TO_BASE64(SHA512('zoeyjohnson_42@example.com')),
  TO_BASE64(SHA512('chocolover@example.com')),
  TO_BASE64(SHA512('nkim@example.com')),
  TO_BASE64(SHA512('operez@example.com')),
  TO_BASE64(SHA512('npark@example.com')),
  TO_BASE64(SHA512('okim@example.com')),
  TO_BASE64(SHA512('alee@example.com')),
  TO_BASE64(SHA512('avakat03@example.com')),
  TO_BASE64(SHA512('masonkim03@example.com')),
  TO_BASE64(SHA512('maximilian.becker1@example.com')),
  TO_BASE64(SHA512('lena.schulz95@example.com')),
  TO_BASE64(SHA512('a.rodriguez@example.com')),
  TO_BASE64(SHA512('d.alvarez@example.com')),
  TO_BASE64(SHA512('emily.w@example.com')),
  TO_BASE64(SHA512('ryanevans@example.com')),
  TO_BASE64(SHA512('trevonmoreno@example.com')),
  TO_BASE64(SHA512('liam.garcia1@example.com')),
  TO_BASE64(SHA512('bellawong99@example.com')),
  TO_BASE64(SHA512('lilyperez_56@example.com')),
  TO_BASE64(SHA512('avery.coleman@example.com')),
  TO_BASE64(SHA512('bryan.ramirez@example.com')),
  TO_BASE64(SHA512('lucasmartinez33@example.com')),
  TO_BASE64(SHA512('mia.alvarez@example.com')),
  TO_BASE64(SHA512('ethan_kaur12@example.com')),
  TO_BASE64(SHA512('aiden_chen12@example.com')),
  TO_BASE64(SHA512('leahkaur99@example.com')),
  TO_BASE64(SHA512('maxbaker96@example.com')),
  TO_BASE64(SHA512('joshua.williams82@example.com')),
  TO_BASE64(SHA512('beachbabe@example.com')),
  TO_BASE64(SHA512('cchang@example.com')),
  TO_BASE64(SHA512('egonzalez@example.com')),
  TO_BASE64(SHA512('inguyen@example.com')),
  TO_BASE64(SHA512('myang@example.com')),
  TO_BASE64(SHA512('enguyen@example.com')),
  TO_BASE64(SHA512('moh@example.com')),
  TO_BASE64(SHA512('wchoi@example.com')),
  TO_BASE64(SHA512('apark@example.com')),
  TO_BASE64(SHA512('nkim@example.com')),
  TO_BASE64(SHA512('ethanlim90@example.com')),
  TO_BASE64(SHA512('miawu23@example.com')),
  TO_BASE64(SHA512('danielteo89@example.com')),
  TO_BASE64(SHA512('sebastian.larsen@example.com')),
  TO_BASE64(SHA512('hannes.schneider@example.com')),
  TO_BASE64(SHA512('p.sanchez@example.com')),
  TO_BASE64(SHA512('sophia.clark@example.com')),
  TO_BASE64(SHA512('dante_patel@example.com')),
  TO_BASE64(SHA512('trevorchoi@example.com')),
  TO_BASE64(SHA512('williamrossi@example.com')),
  TO_BASE64(SHA512('noahkim@example.com')),
  TO_BASE64(SHA512('emartinez@example.com')),
  TO_BASE64(SHA512('logankhan@example.com')),
  TO_BASE64(SHA512('liamchan_88@example.com')),
  TO_BASE64(SHA512('oliverchoi@example.com')),
  TO_BASE64(SHA512('noahkim@example.com')),
  TO_BASE64(SHA512('mateo.chen@example.com')),
  TO_BASE64(SHA512('mohammedmohamed@example.com')),
  TO_BASE64(SHA512('noahrobinson24@example.com')),
  TO_BASE64(SHA512('landonchang99@example.com')),
  TO_BASE64(SHA512('asherpatel23@example.com')),
  TO_BASE64(SHA512('stella.phillips@example.com')),
  TO_BASE64(SHA512('nataliesmith@example.com')),
  TO_BASE64(SHA512('fatima.khan99@example.com')),
  TO_BASE64(SHA512('gaminggalaxy@example.com')),
  TO_BASE64(SHA512('jkim@example.com')),
  TO_BASE64(SHA512('stran@example.com')),
  TO_BASE64(SHA512('emilypark87@example.com')),
  TO_BASE64(SHA512('lucas_chang93@example.com')),
  TO_BASE64(SHA512('ingrid.johansson@example.com')),
  TO_BASE64(SHA512('oskar.petersen93@example.com')),
  TO_BASE64(SHA512('s.navarro@example.com')),
  TO_BASE64(SHA512('j.anderson@example.com')),
  TO_BASE64(SHA512('sophie.liu@example.com')),
  TO_BASE64(SHA512('liam.rossi@example.com')),
  TO_BASE64(SHA512('emily.nguyen89@example.com')),
  TO_BASE64(SHA512('zhernandez21@example.com')),
  TO_BASE64(SHA512('isaacturner49@example.com')),
  TO_BASE64(SHA512('isabella.hall@example.com')),
  TO_BASE64(SHA512('ilovemydog@example.com')),
  TO_BASE64(SHA512('moh@example.com')),
  TO_BASE64(SHA512('nina.larsen76@example.com')),
  TO_BASE64(SHA512('a.garcia@example.com')),
  TO_BASE64(SHA512('connorjones@example.com')),
  TO_BASE64(SHA512('javier_chen@example.com')),
  TO_BASE64(SHA512('avamendoza@example.com')),
  TO_BASE64(SHA512('aishawilliams@example.com')),
  TO_BASE64(SHA512('liamali@example.com')),
  TO_BASE64(SHA512('miguel.patel@example.com')),
  TO_BASE64(SHA512('isaac.wong@example.com')),
  TO_BASE64(SHA512('ilee@example.com')),
  TO_BASE64(SHA512('olivia.johnson@example.com')),
  TO_BASE64(SHA512('avafernandez@example.com')),
  TO_BASE64(SHA512('avaramirez@example.com')),
  TO_BASE64(SHA512('mollywilson@example.com')),
  TO_BASE64(SHA512('ethan_liu@example.com')),
  TO_BASE64(SHA512('s.johnson@example.com')),
  TO_BASE64(SHA512('hazelgreen@example.com')),
  TO_BASE64(SHA512('lila.hernandez@example.com')),
  TO_BASE64(SHA512('emilia.young@example.com')),
  TO_BASE64(SHA512('mgarcia@example.com')),
  TO_BASE64(SHA512('blarson@example.com')),
  TO_BASE64(SHA512('sross@example.com')),
  TO_BASE64(SHA512('syang@example.com')),
  TO_BASE64(SHA512('lramirez@example.com')),
  TO_BASE64(SHA512('natalie_singh@example.com')),
  TO_BASE64(SHA512('yusrasmith@example.com')),
  TO_BASE64(SHA512('avaperez@example.com')),
  TO_BASE64(SHA512('noah.kumar@example.com')),
  TO_BASE64(SHA512('calebsingh@example.com')),
  TO_BASE64(SHA512('s.allen@example.com')),
  TO_BASE64(SHA512('olivia.martinez@example.com')),
  TO_BASE64(SHA512('avamartinez1@example.com')),
  TO_BASE64(SHA512('sophieberger@example.com')),
  TO_BASE64(SHA512('adrianagarcia33@example.com')),
  TO_BASE64(SHA512('ninafernandez91@example.com')),
  TO_BASE64(SHA512('sophiehernandez11@example.com')),
  TO_BASE64(SHA512('partyanimal123@example.com')),
  TO_BASE64(SHA512('ilovecake87@example.com')),
  TO_BASE64(SHA512('adventureseeker456@example.com')),
  TO_BASE64(SHA512('fitnessfreak99@example.com')),
  TO_BASE64(SHA512('musiclover321@example.com')),
  TO_BASE64(SHA512('beachbum777@example.com')),
  TO_BASE64(SHA512('foodie4life@example.com')),
  TO_BASE64(SHA512('bookworm234@example.com')),
  TO_BASE64(SHA512('gamer4ever555@example.com')),
  TO_BASE64(SHA512('naturelover789@example.com'))
];

-- SELECT AVG(TotalPurchases)
-- FROM `users.purchases`
-- WHERE TO_BASE64(SHA512(email)) IN UNNEST(HASHED_EMAIL_ARRAY)

SELECT AVG(TotalPurchases)
FROM `users.purchases`